artifacts:
  - path: hello-appveyor.zip
    name: hello-appveyor
  - path: '*.log'
    name: logs

branches:
  only:
    - master

build_script:
  - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"
  - set PATH=C:\Qt\5.14.2\msvc2017_64\bin;C:\Qt\Tools\QtCreator\bin;C:\Python39-x64;C:\Python39-x64\Scripts;%PATH% > nul 2>&1
  - pip install mugisync
  - mugisync --help
  - qmake > build_qmake.log 2>&1
  - jom release > build_jom.log 2>&1
  - jom clean > nul 2>&1
  - windeployqt release\hello-appveyor.exe > deploy.log 2>&1
  - 7z a hello-appveyor.zip release > zip.log 2>&1

deploy:
  description: 'hello-appveyor'
  provider: GitHub
  auth_token:
    secure: gcYWBlGRr48R9W3Snz+xXmLh1TIT/wYLnoYgdaCRlKiWA4SyZkNC3b+GZdIiyCra
  on:
    branch: master